<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Weekend in the Bay: Your Ultimate Itinerary</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Base styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Lighter, cleaner background (Slate-50) */
            color: #334155; /* Slate-700 for main text */
            scroll-behavior: smooth;
        }
        /* Print-specific styles */
        @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
           .no-print { display: none; }
           .page-break { page-break-before: always; }
        }
        /* Timeline styling */
       .timeline-item::before {
            content: '';
            position: absolute;
            left: 1.25rem; /* 20px */
            top: 2.5rem; /* 40px */
            bottom: -1rem; /* -16px */
            width: 3px;
            background-color: #e2e8f0; /* Slate-200 */
        }
       .timeline-item:last-child::before { display: none; }
       .timeline-icon {
            position: absolute;
            left: 1.25rem; /* 20px */
            top: 1.5rem; /* 24px */
            transform: translateX(-50%);
            width: 2.5rem; /* 40px */
            height: 2.5rem; /* 40px */
            border-radius: 9999px;
            background-color: white;
            border: 4px solid #e2e8f0; /* Slate-200 for a solid ring */
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        /* Accordion styles */
       .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
        input[type="checkbox"]:checked + label +.accordion-content {
            max-height: 1000px; /* Generous max-height */
        }
        input[type="checkbox"] { display: none; }
       .accordion-label svg { transition: transform 0.3s ease-in-out; }
        input[type="checkbox"]:checked +.accordion-label svg { transform: rotate(180deg); }
        
        /* Modal styles */
       .modal {
            transition: opacity 0.25s ease;
        }
       .modal-active {
            opacity: 1;
            pointer-events: auto;
        }
       .modal-inactive {
            opacity: 0;
            pointer-events: none;
        }
        /* Spinner */
       .loader {
            border-top-color: #4f46e5; /* Indigo-600 */
            animation: spinner 1.5s linear infinite;
        }
        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* AI Response Container */
       .ai-response-container {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, margin-top 0.5s ease-in-out, opacity 0.5s ease-in-out;
            opacity: 0;
        }
       .ai-response-container.active {
            max-height: 1000px; /* Generous max-height */
            margin-top: 1rem; /* 16px */
            opacity: 1;
        }
        .image-loader {
            width: 100%;
            height: 256px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f1f5f9;
            border-radius: 1rem;
        }
    </style>
</head>
<body class="antialiased">

    <div class="max-w-4xl mx-auto p-4 sm:p-6 lg:p-8">

        <header class="text-center mb-12">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-slate-800 mb-2">A Weekend in the Bay</h1>
            <p class="text-lg text-slate-500">Your AI-Powered Guide: July 31 – August 3, 2025</p>
        </header>

        <nav class="no-print bg-white p-4 rounded-2xl shadow-sm border border-slate-200 mb-8 sticky top-4 z-20">
            <h3 class="font-bold text-center text-indigo-700 mb-2">Jump to Day</h3>
            <div class="flex justify-center gap-4">
                <a href="#day1" class="font-semibold text-slate-600 hover:text-indigo-600 transition-colors">Thursday</a>
                <a href="#day2" class="font-semibold text-slate-600 hover:text-indigo-600 transition-colors">Friday</a>
                <a href="#day3" class="font-semibold text-slate-600 hover:text-indigo-600 transition-colors">Saturday</a>
                <a href="#day4" class="font-semibold text-slate-600 hover:text-indigo-600 transition-colors">Sunday</a>
            </div>
        </nav>

        <div class="bg-white p-4 sm:p-6 rounded-2xl shadow-sm border border-slate-200 mb-12">
            <input type="checkbox" id="planning-accordion" class="peer" checked/>
            <label for="planning-accordion" class="accordion-label flex justify-between items-center cursor-pointer">
                <h2 class="text-2xl font-bold text-slate-800">Essential Pre-Trip Planning</h2>
                <svg class="w-6 h-6 text-indigo-600 no-print" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>
            </label>
            <div class="accordion-content border-t-2 border-slate-100 mt-4 pt-4">
                <div class="grid md:grid-cols-2 gap-x-8 gap-y-6">
                    <div>
                        <h3 class="font-bold text-lg text-indigo-700 mb-2">What to Wear</h3>
                        <p class="text-sm">Always bring a light jacket in San Francisco. The weather changes fast, and layering is the key to comfort. Comfortable walking shoes are non-negotiable.</p>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg text-indigo-700 mb-2">What to Bring</h3>
                        <ul class="list-disc list-inside text-sm space-y-1">
                            <li>Reusable Water Bottles & Backpack</li>
                            <li>Portable Phone Charger</li>
                            <li>Sunscreen & Sunglasses</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg text-indigo-700 mb-2">Your Futuristic Ride: Waymo</h3>
                        <p class="text-sm">Before the trip, download the <a href="https://waymo.com/" target="_blank" class="text-indigo-600 hover:underline font-semibold">Waymo</a> app and set up your account. It's a unique and practical way to get around San Francisco.</p>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg text-indigo-700 mb-2">Smart Savings</h3>
                        <p class="text-sm">This itinerary notes where to use the "Museums for All" EBT discount for significant savings at major attractions.</p>
                    </div>
                     <div class="md:col-span-2">
                        <h3 class="font-bold text-lg text-indigo-700 mb-2">Ferry Tickets</h3>
                        <p class="text-sm">Ferry tickets can be purchased directly at the terminal before departure. No need for advance planning with a transit card.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="itinerary-container">
            <div class="mb-12 page-break" id="day1">
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 mb-6">
                    <div class="flex justify-between items-center">
                           <h2 class="text-3xl font-bold text-slate-900">Day 1: Thursday, July 31</h2>
                           <button class="no-print bg-indigo-600 text-white text-sm font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors ai-action-button" data-action="logistics" data-day="day1" data-title="Day 1 Logistics Helper">✨ Ask a Question</button>
                    </div>
                    <p class="text-slate-500 mt-1">SF Arrival: Ferry, Views, and an Afternoon on the Piers</p>
                </div>
                <div class="relative space-y-4">
                    <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-blue-100 border-blue-200"><svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v4a3 3 0 003 3z"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-blue-600">Morning Ferry to SF</p>
                            <p class="text-sm mt-2 text-slate-600">The adventure begins with a classic Bay Area experience: a ferry ride from the <a href="https://www.google.com/maps/search/?api=1&query=Jack+London+Square+Ferry+Terminal" target="_blank" class="text-indigo-600 hover:underline font-semibold">Oakland Ferry Terminal</a>. Weekday departures are frequent; good options include the <strong>9:05 AM</strong> (arrives SF 9:30 AM) or the <strong>10:05 AM</strong> (arrives SF 10:30 AM).</p>
                            <div class="mt-3 text-sm italic text-slate-500"><strong>Insider Tip:</strong> For the best photos of the SF skyline on approach, grab a spot on the right (starboard) side of the ferry.</div>
                            <div class="mt-4 pt-4 border-t border-slate-100 flex flex-wrap gap-2 no-print">
                                <button class="ai-action-button text-xs bg-cyan-100 text-cyan-700 font-semibold py-1 px-3 rounded-full hover:bg-cyan-200 transition-colors" data-action="weather" data-context="a ferry on the San Francisco Bay">What to Wear Here?</button>
                            </div>
                            <div class="ai-response-container"></div>
                        </div>
                    </div>
                    <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-rose-100 border-rose-200"><svg class="w-6 h-6 text-rose-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5H1v14h18v-6a3 3 0 00-3-3h-5a3 3 0 01-3-3V5z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 5V1M21 4h-6"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-rose-600">~11:00 AM</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">Lunch at the Ferry Building</h4>
                            <p class="text-sm mt-2 text-slate-600">Arrive at the historic <a href="https://www.google.com/maps/search/?api=1&query=Ferry+Building+San+Francisco" target="_blank" class="text-indigo-600 hover:underline font-semibold">Ferry Building Marketplace</a>, a gourmet paradise. Explore the stalls of local artisan cheese makers, bakers, and chefs. For a fantastic lunch, try the delicious sandwiches and salads at <a href="https://www.acmesf.com/" target="_blank" class="text-indigo-600 hover:underline font-semibold">Acme Bread Company</a> or the famous oysters and clam chowder at <a href="https://hogislandoysters.com/" target="_blank" class="text-indigo-600 hover:underline font-semibold">Hog Island Oyster Co.</a></p>
                            <div class="mt-3 text-sm italic text-slate-500"><strong>Insider Tip:</strong> Grab your food to-go and walk out the back of the building. There are public benches with fantastic, less-crowded views of the Bay Bridge.</div>
                        </div>
                    </div>
                    <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-emerald-100 border-emerald-200"><svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-emerald-600">~12:30 PM</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">Iconic Bridge Views</h4>
                            <p class="text-sm mt-2 text-slate-600">Take a Waymo to the <a href="https://www.google.com/maps/search/?api=1&query=Golden+Gate+Overlook" target="_blank" class="text-indigo-600 hover:underline font-semibold">Golden Gate Overlook</a> for classic, postcard-perfect photos of the bridge against the backdrop of the city and bay.</p>
                             <div class="mt-3 text-sm italic text-slate-500"><strong>Insider Tip:</strong> For a slightly different and often less crowded angle, walk a few hundred feet east towards the Torpedo Wharf for a great low-angle shot of the bridge.</div>
                            <div class="mt-4 pt-4 border-t border-slate-100 flex flex-wrap gap-2 no-print">
                                <button class="ai-action-button text-xs bg-purple-100 text-purple-700 font-semibold py-1 px-3 rounded-full hover:bg-purple-200 transition-colors" data-action="caption" data-context="Golden Gate Bridge Overlook">Generate Captions</button>
                                <button class="ai-action-button text-xs bg-cyan-100 text-cyan-700 font-semibold py-1 px-3 rounded-full hover:bg-cyan-200 transition-colors" data-action="weather" data-context="the Golden Gate Bridge Overlook">What to Wear Here?</button>
                            </div>
                            <div class="ai-response-container"></div>
                        </div>
                    </div>
                    <div class="timeline-item pl-16 relative">
                         <div class="timeline-icon bg-amber-100 border-amber-200"><svg class="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-amber-600">~1:30 PM - 4:00 PM</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">A World of Hands-On Science</h4>
                            <p class="text-sm mt-2 text-slate-600">Dive into hundreds of mind-bending exhibits at the <strong><a href="https://www.google.com/maps/search/?api=1&query=Exploratorium+San+Francisco" target="_blank" class="text-indigo-600 hover:underline font-semibold">Exploratorium</a></strong>, a playground for the curious where you can touch, tinker, and play with the principles of science and art. It closes at 5 PM.</p>
                            <div class="mt-3 text-sm italic text-slate-500"><strong>Insider Tip:</strong> The Tactile Dome is a separate, ticketed experience where you navigate a series of textures in total darkness. Book this unique sensory adventure well in advance if it sounds interesting.</div>
                            <div class="text-sm font-bold text-green-800 bg-green-100 rounded-lg px-4 py-2 mt-3 inline-block">Cost: $1 per person (up to 4) with EBT</div>
                            <div class="mt-4 pt-4 border-t border-slate-100 flex flex-wrap gap-2 no-print">
                                <button class="ai-action-button text-xs bg-sky-100 text-sky-700 font-semibold py-1 px-3 rounded-full hover:bg-sky-200 transition-colors" data-action="teen" data-context="Exploratorium">Teen-Friendly Tip</button>
                            </div>
                            <div class="ai-response-container"></div>
                        </div>
                    </div>
                    <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-purple-100 border-purple-200"><svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-purple-600">4:00 PM - 5:30 PM</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">Vintage Arcade Fun</h4>
                            <p class="text-sm mt-2 text-slate-600">Step back in time at the <strong><a href="https://www.google.com/maps/search/?api=1&query=Musée+Mécanique+San+Francisco" target="_blank" class="text-indigo-600 hover:underline font-semibold">Musée Mécanique</a></strong>, a one-of-a-kind collection of over 300 vintage, coin-operated arcade games and mechanical wonders. The sounds of old-timey pianos and whirring machines create a truly unique atmosphere.</p>
                             <div class="mt-3 text-sm italic text-slate-500"><strong>Insider Tip:</strong> Don't miss "Laffing Sal," the famously creepy automaton who has been unsettling visitors for decades. Also, look for the photo booths for a great vintage-style souvenir.</div>
                            <div class="text-sm font-bold text-slate-800 bg-slate-100 rounded-lg px-4 py-2 mt-3 inline-block">Cost: Free Entry (bring cash for games)</div>
                        </div>
                    </div>
                     <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-rose-100 border-rose-200"><svg class="w-6 h-6 text-rose-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5H1v14h18v-6a3 3 0 00-3-3h-5a3 3 0 01-3-3V5z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 5V1M21 4h-6"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-rose-600">6:00 PM - 7:30 PM</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">Dinner in the Mission District</h4>
                            <p class="text-sm mt-2 text-slate-600">Take a Waymo to the vibrant Mission District. Excellent choices include <a href="https://www.google.com/maps/search/?api=1&query=Burma+Love+San+Francisco" target="_blank" class="text-indigo-600 hover:underline font-semibold">Burma Love</a> for incredible Burmese cuisine (the Tea Leaf Salad is a must-try) and <a href="https://www.google.com/maps/search/?api=1&query=La+Venganza+Taqueria+Mission+SF" target="_blank" class="text-indigo-600 hover:underline font-semibold">La Venganza</a> for delicious, creative plant-based tacos.</p>
                             <div class="mt-3 text-sm italic text-slate-500"><strong>Insider Tip:</strong> After dinner, grab a scoop of unique ice cream from <a href="https://www.google.com/maps/search/?api=1&query=Garden+Creamery+San+Francisco" target="_blank" class="text-indigo-600 hover:underline font-semibold">Garden Creamery</a> or a delicious boba from <a href="https://www.google.com/maps/search/?api=1&query=Boba+Guys+Mission+SF" target="_blank" class="text-indigo-600 hover:underline font-semibold">Boba Guys</a>.</div>
                        </div>
                    </div>
                     <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-blue-100 border-blue-200"><svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-blue-600">Evening Ferry to Oakland</p>
                            <p class="text-sm mt-2 text-slate-600">Catch the ferry from the <a href="https://www.google.com/maps/search/?api=1&query=Ferry+Building+San+Francisco" target="_blank" class="text-indigo-600 hover:underline font-semibold">Ferry Building</a> back to <a href="https://www.google.com/maps/search/?api=1&query=Jack+London+Square" target="_blank" class="text-indigo-600 hover:underline font-semibold">Jack London Square</a>. Good departure options include the <strong>6:40 PM, 7:30 PM, or 8:20 PM</strong> ferries. The ride back offers a spectacular view of the city lights and the Bay Bridge lit up at night.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mb-12 page-break" id="day2">
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 mb-6">
                    <div class="flex justify-between items-center">
                           <h2 class="text-3xl font-bold text-slate-900">Day 2: Friday, August 1</h2>
                           <button class="no-print bg-indigo-600 text-white text-sm font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors ai-action-button" data-action="logistics" data-day="day2" data-title="Day 2 Logistics Helper">✨ Ask a Question</button>
                    </div>
                    <p class="text-slate-500 mt-1">Choose Your Redwood Adventure!</p>
                </div>

                <div class="mb-8 p-4 border-2 border-dashed border-sky-300 rounded-2xl bg-sky-50">
                    <h3 class="text-2xl font-bold text-sky-800 mb-4">Track A: The East Bay Local</h3>
                    <div class="relative space-y-4">
                        <div class="timeline-item pl-16 relative">
                            <div class="timeline-icon bg-green-100 border-green-200"><svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2h8a2 2 0 002-2v-1a2 2 0 012-2h1.945M7.8 15.243l.32-2.323a2.5 2.5 0 014.764 0l.32 2.323a2.5 2.5 0 01-1.33 2.91l-1.33.665a2.5 2.5 0 01-2.44 0l-1.33-.665a2.5 2.5 0 01-1.33-2.91z"></path></svg></div>
                            <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                                <p class="font-semibold text-sm text-green-600">10:00 AM - 1:00 PM</p>
                                <h4 class="font-bold text-xl text-slate-800 mt-1">Hike at Reinhardt Redwood Regional Park</h4>
                                <p class="text-sm mt-2 text-slate-600">The most convenient option, this park in the Oakland hills is home to the largest remaining natural grove of coast redwoods in the East Bay. The paved, accessible Stream Trail is perfect for an easygoing hike. <a href="https://www.ebparks.org/parks/reinhardt-redwood" target="_blank" class="text-indigo-600 hover:underline font-semibold">Learn more</a>.</p>
                            </div>
                        </div>
                        <div class="timeline-item pl-16 relative">
                            <div class="timeline-icon bg-rose-100 border-rose-200"><svg class="w-6 h-6 text-rose-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5H1v14h18v-6a3 3 0 00-3-3h-5a3 3 0 01-3-3V5z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 5V1M21 4h-6"></path></svg></div>
                            <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                                <p class="font-semibold text-sm text-rose-600">1:00 PM - 2:00 PM</p>
                                <h4 class="font-bold text-xl text-slate-800 mt-1">Lunch in the Laurel District</h4>
                                <p class="text-sm mt-2 text-slate-600">After your hike, grab lunch nearby at <strong><a href="https://www.google.com/maps/search/?api=1&query=Jo's+Modern+Thai+Oakland" target="_blank" class="text-indigo-600 hover:underline font-semibold">Jo's Modern Thai</a></strong>, a Michelin Bib Gourmand restaurant with fantastic flavors and great vegan options.</p>
                            </div>
                        </div>
                        <div class="timeline-item pl-16 relative">
                            <div class="timeline-icon bg-purple-100 border-purple-200"><svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg></div>
                            <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                                <p class="font-semibold text-sm text-purple-600">2:00 PM onwards</p>
                                <h4 class="font-bold text-xl text-slate-800 mt-1">Afternoon at Chabot Space & Science Center</h4>
                                <p class="text-sm mt-2 text-slate-600">Head up the hill to the <strong><a href="https://www.google.com/maps/search/?api=1&query=Chabot+Space+%26+Science+Center" target="_blank" class="text-indigo-600 hover:underline font-semibold">Chabot Space & Science Center</a></strong>. Explore their fascinating exhibits and catch a show at the full-dome planetarium.</p>
                                <div class="text-sm font-bold text-green-800 bg-green-100 rounded-lg px-3 py-1 mt-2 inline-block">Cost: $1/person with EBT</div>
                            </div>
                        </div>
                         <div class="timeline-item pl-16 relative">
                            <div class="timeline-icon bg-orange-100 border-orange-200"><svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"></path></svg></div>
                            <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                                <p class="font-semibold text-sm text-orange-600">5:00 PM - 9:00 PM</p>
                                <h4 class="font-bold text-xl text-slate-800 mt-1">Oakland First Fridays</h4>
                                <p class="text-sm mt-2 text-slate-600">Experience a massive, free street festival on Telegraph Ave. Dinner is from the amazing food trucks. A great option is <strong>Señor Sisig</strong>, a famous Filipino-fusion truck with options for everyone.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="p-4 border-2 border-dashed border-red-300 rounded-2xl bg-red-50">
                    <h3 class="text-2xl font-bold text-red-800 mb-4">Track B: The Coastal Redwood Adventure</h3>
                    <div class="relative space-y-4">
                        <div class="timeline-item pl-16 relative">
                            <div class="timeline-icon bg-green-100 border-green-200"><svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2h8a2 2 0 002-2v-1a2 2 0 012-2h1.945M7.8 15.243l.32-2.323a2.5 2.5 0 014.764 0l.32 2.323a2.5 2.5 0 01-1.33 2.91l-1.33.665a2.5 2.5 0 01-2.44 0l-1.33-.665a2.5 2.5 0 01-1.33-2.91z"></path></svg></div>
                            <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                                <p class="font-semibold text-sm text-green-600">10:00 AM - 1:00 PM</p>
                                <h4 class="font-bold text-xl text-slate-800 mt-1">Hike at Henry Cowell Redwoods State Park</h4>
                                <p class="text-sm mt-2 text-slate-600">Head south towards Santa Cruz to visit this stunning park. The main attraction is the 0.8-mile Redwood Grove Loop Trail, an accessible walk through a magnificent old-growth forest. For extra fun, the <a href="https://www.roaringcamp.com/" target="_blank" class="text-indigo-600 hover:underline font-semibold">Roaring Camp Railroads</a> steam train runs right next to the park. <a href="https://www.parks.ca.gov/?page_id=546" target="_blank" class="text-indigo-600 hover:underline font-semibold">Learn more</a>.</p>
                            </div>
                        </div>
                        <div class="timeline-item pl-16 relative">
                            <div class="timeline-icon bg-rose-100 border-rose-200"><svg class="w-6 h-6 text-rose-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5H1v14h18v-6a3 3 0 00-3-3h-5a3 3 0 01-3-3V5z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 5V1M21 4h-6"></path></svg></div>
                            <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                                <p class="font-semibold text-sm text-rose-600">1:00 PM - 2:00 PM</p>
                                <h4 class="font-bold text-xl text-slate-800 mt-1">Lunch in Felton</h4>
                                <p class="text-sm mt-2 text-slate-600">After the park, have lunch in the rustic town of Felton. A great choice is the <a href="https://www.google.com/maps/search/?api=1&query=Humble+Sea+Tavern+Felton" target="_blank" class="text-indigo-600 hover:underline font-semibold">Humble Sea Tavern</a>, serving delicious gastropub fare with a great local vibe.</p>
                            </div>
                        </div>
                        <div class="timeline-item pl-16 relative">
                            <div class="timeline-icon bg-purple-100 border-purple-200"><svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg></div>
                            <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                                <p class="font-semibold text-sm text-purple-600">2:30 PM onwards</p>
                                <h4 class="font-bold text-xl text-slate-800 mt-1">Santa Cruz Beach Boardwalk</h4>
                                <p class="text-sm mt-2 text-slate-600">Drive to the coast for an afternoon of classic California fun at the <a href="https://beachboardwalk.com/" target="_blank" class="text-indigo-600 hover:underline font-semibold">Santa Cruz Beach Boardwalk</a>. Enjoy the rides, arcade games, and seaside atmosphere of this iconic amusement park.</p>
                            </div>
                        </div>
                         <div class="timeline-item pl-16 relative">
                            <div class="timeline-icon bg-orange-100 border-orange-200"><svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"></path></svg></div>
                            <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                                <p class="font-semibold text-sm text-orange-600">Evening</p>
                                <h4 class="font-bold text-xl text-slate-800 mt-1">Dinner and Return</h4>
                                <p class="text-sm mt-2 text-slate-600">Have dinner at the popular <a href="https://www.google.com/maps/search/?api=1&query=The+Crow's+Nest+Santa+Cruz" target="_blank" class="text-indigo-600 hover:underline font-semibold">The Crow's Nest</a> for great food and harbor views before driving back. Note that Oakland First Fridays is not logistically feasible with this itinerary.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-12 page-break" id="day3">
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 mb-6">
                    <div class="flex justify-between items-center">
                           <h2 class="text-3xl font-bold text-slate-900">Day 3: Saturday, August 2</h2>
                           <button class="no-print bg-indigo-600 text-white text-sm font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors ai-action-button" data-action="logistics" data-day="day3" data-title="Day 3 Logistics Helper">✨ Ask a Question</button>
                    </div>
                    <p class="text-slate-500 mt-1">A Day of Festivals, Gardens & City Views</p>
                </div>
                <div class="relative space-y-4">
                    <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-purple-100 border-purple-200"><svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-purple-600">11:00 AM - 2:00 PM</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">Choose Your Morning Adventure!</h4>
                            <div class="mt-4 space-y-4">
                                <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                                    <h5 class="font-bold text-lg text-slate-800">Option A: Cultural Festival</h5>
                                    <p class="text-sm mt-1">Immerse yourselves in the <strong><a href="https://nihonmachistreetfair.org/" target="_blank" class="text-indigo-600 hover:underline font-semibold">Nihonmachi Street Fair</a></strong> in <strong><a href="https://www.sfjapantown.org/" target="_blank" class="text-indigo-600 hover:underline font-semibold">Japantown</a></strong>, celebrating the rich traditions and dazzling diversity of the Asian American, Native Hawaiian, and Pacific Islander communities. Explore the Japan Center Malls, see the iconic Peace Pagoda, and graze at the Food Fest.</p>
                                    <div class="mt-3 text-sm italic text-slate-500"><strong>Insider Tip:</strong> Look for <a href="https://www.google.com/maps/search/?api=1&query=Mochill+Mochi+Donut+Japantown+SF" target="_blank" class="text-indigo-600 hover:underline font-semibold">Mochill</a> for incredible mochi donuts, a perfect treat.</div>
                                </div>
                                <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                                    <h5 class="font-bold text-lg text-slate-800">Option B: Quirky California Fun</h5>
                                    <p class="text-sm mt-1">For a truly unique experience, drive to Pacifica for the <strong><a href="https://www.surfdogchampionships.com/" target="_blank" class="text-indigo-600 hover:underline font-semibold">World Dog Surfing Championships</a></strong> at <a href="https://www.google.com/maps/search/?api=1&query=Linda+Mar+Beach+Pacifica" target="_blank" class="text-indigo-600 hover:underline font-semibold">Linda Mar Beach</a>. Afterwards, explore the stunning coastal bluffs at nearby <a href="https://www.google.com/maps/search/?api=1&query=Mori+Point+Pacifica" target="_blank" class="text-indigo-600 hover:underline font-semibold">Mori Point</a>.</p>
                                    <div class="text-sm font-bold text-slate-800 bg-slate-200 rounded-lg px-3 py-1 mt-2 inline-block">Cost: Free to attend</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-green-100 border-green-200"><svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-green-600">Afternoon</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">Golden Gate Park Gardens</h4>
                            <p class="text-sm mt-2 text-slate-600">Spend the afternoon exploring two beautiful, adjacent gardens. Start at the <strong><a href="https://www.google.com/maps/search/?api=1&query=San+Francisco+Botanical+Garden" target="_blank" class="text-indigo-600 hover:underline font-semibold">SF Botanical Garden</a></strong>, then visit the serene and iconic <strong><a href="https://www.google.com/maps/search/?api=1&query=Japanese+Tea+Garden+San+Francisco" target="_blank" class="text-indigo-600 hover:underline font-semibold">Japanese Tea Garden</a></strong> right next door.</p>
                             <div class="text-sm font-bold text-green-800 bg-green-100 rounded-lg px-4 py-2 mt-3 inline-block">Cost: Free with EBT card</div>
                        </div>
                    </div>
                    <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-rose-100 border-rose-200"><svg class="w-6 h-6 text-rose-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5H1v14h18v-6a3 3 0 00-3-3h-5a3 3 0 01-3-3V5z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 5V1M21 4h-6"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-rose-600">Evening</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">Dinner in Hayes Valley</h4>
                            <p class="text-sm mt-2 text-slate-600">Take a Waymo to the trendy Hayes Valley neighborhood. For dinner, consider <a href="https://www.google.com/maps/search/?api=1&query=a+Mano+San+Francisco" target="_blank" class="text-indigo-600 hover:underline font-semibold">a Mano</a> for delicious handmade pasta (they have great vegetable-based dishes) or <a href="https://www.google.com/maps/search/?api=1&query=Lily+San+Francisco" target="_blank" class="text-indigo-600 hover:underline font-semibold">Lily</a> for incredible modern Vietnamese food.</p>
                             <div class="mt-3 text-sm italic text-slate-500"><strong>Insider Tip:</strong> For a post-dinner treat, stop by <a href="https://www.google.com/maps/search/?api=1&query=Salt+%26+Straw+Hayes+Valley" target="_blank" class="text-indigo-600 hover:underline font-semibold">Salt & Straw</a> for some of the most creative and delicious ice cream in the city.</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-12 page-break" id="day4">
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 mb-6">
                    <div class="flex justify-between items-center">
                           <h2 class="text-3xl font-bold text-slate-900">Day 4: Sunday, August 3</h2>
                           <button class="no-print bg-indigo-600 text-white text-sm font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors ai-action-button" data-action="logistics" data-day="day4" data-title="Day 4 Logistics Helper">✨ Ask a Question</button>
                    </div>
                    <p class="text-slate-500 mt-1">East Bay Fun & A Logistical Farewell</p>
                </div>
                <div class="relative space-y-4">
                     <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-purple-100 border-purple-200"><svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-purple-600">Morning & Lunch</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">Choose Your Final Morning!</h4>
                            <div class="mt-4 space-y-4">
                                <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                                    <h5 class="font-bold text-lg text-slate-800">Option A: Gardens & A Vegan Deli</h5>
                                    <p class="text-sm mt-1">Visit the <strong><a href="https://botanicalgarden.berkeley.edu/" target="_blank" class="text-indigo-600 hover:underline font-semibold">UC Botanical Garden</a></strong> ($3/person with EBT), then have lunch at the legendary vegan deli, <strong><a href="https://www.thebutchersveganson.com/" target="_blank" class="text-indigo-600 hover:underline font-semibold">The Butcher's Son</a></strong>.</p>
                                </div>
                                <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                                    <h5 class="font-bold text-lg text-slate-800">Option B: Treasure Hunting</h5>
                                    <p class="text-sm mt-1">Spend the morning at the massive <strong><a href="https://www.alamedapointantiquesfaire.com/" target="_blank" class="text-indigo-600 hover:underline font-semibold">Alameda Point Antiques Faire</a></strong>, with over 800 vendor booths. It's a huge treasure hunt with food trucks for lunch.</p>
                                    <div class="text-sm font-bold text-slate-800 bg-slate-200 rounded-lg px-3 py-1 mt-2 inline-block">Cost: ~$10-15 entry (CASH ONLY)</div>
                                </div>
                            </div>
                        </div>
                    </div>
                     <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-teal-100 border-teal-200"><svg class="w-6 h-6 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-teal-600">Afternoon</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">Final Activity: Quirky Golf</h4>
                            <p class="text-sm mt-2 text-slate-600">Cap the afternoon with a fun, low-key round at <strong><a href="https://www.google.com/maps/search/?api=1&query=Subpar+Miniature+Golf+Alameda" target="_blank" class="text-indigo-600 hover:underline font-semibold">Subpar Miniature Golf</a></strong>.</p>
                            <div class="mt-3 text-sm italic text-slate-500"><strong>Insider Tip:</strong> After your game, get some boba right next door at <a href="https://www.google.com/maps/search/?api=1&query=Boba+Pure+Alameda" target="_blank" class="text-indigo-600 hover:underline font-semibold">Boba Pure</a>.</div>
                        </div>
                    </div>
                    <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-rose-100 border-rose-200"><svg class="w-6 h-6 text-rose-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5H1v14h18v-6a3 3 0 00-3-3h-5a3 3 0 01-3-3V5z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 5V1M21 4h-6"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-rose-600">4:30 PM - 5:30 PM</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">Early Dinner in Oakland's Chinatown</h4>
                            <p class="text-sm mt-2 text-slate-600">Head to Oakland's Chinatown for an early dinner at <strong><a href="https://www.google.com/maps/search/?api=1&query=Shan+Dong+Restaurant+Oakland" target="_blank" class="text-indigo-600 hover:underline font-semibold">Shan Dong</a></strong>. This place is legendary for its incredible, fresh, hand-pulled noodles and delicious dumplings.</p>
                        </div>
                    </div>
                    <div class="timeline-item pl-16 relative">
                        <div class="timeline-icon bg-indigo-100 border-indigo-200"><svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg></div>
                        <div class="ml-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <p class="font-semibold text-sm text-indigo-600">6:00 PM - 7:00 PM</p>
                            <h4 class="font-bold text-xl text-slate-800 mt-1">Luggage Pickup & Departure</h4>
                            <p class="text-sm mt-2 text-slate-600">
                                <span class="font-semibold block">6:00 PM:</span> Leave Oakland and drive to <a href="https://www.google.com/maps/search/?api=1&query=424+Callan+Ave+San+Leandro+CA" target="_blank" class="text-indigo-600 hover:underline font-semibold">424 Callan Ave, San Leandro</a>.<br>
                                <span class="font-semibold block mt-1">6:40 PM:</span> Leave from your home and drive to <strong><a href="https://www.google.com/maps/search/?api=1&query=Oakland+International+Airport+(OAK)" target="_blank" class="text-indigo-600 hover:underline font-semibold">Oakland International Airport (OAK)</a></strong>.<br>
                                <span class="font-semibold block mt-1">7:00 PM:</span> Arrive at OAK for the 8:50 PM flight. This provides ample time to get a Southwest gate pass.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 mt-12 no-print">
            <h2 class="text-2xl font-bold text-slate-800 mb-4">✨ Trip Memories</h2>
            <p class="text-sm text-slate-600 mb-6">Let AI create a unique visual memory of your trip! Click a button to generate a digital postcard summarizing that day's adventures.</p>
            <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <div>
                    <button class="ai-action-button w-full bg-purple-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-purple-700 transition-colors" data-action="imagegen" data-day="day1">Generate Memory for Day 1</button>
                    <div class="ai-image-container mt-4"></div>
                </div>
                 <div>
                    <button class="ai-action-button w-full bg-purple-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-purple-700 transition-colors" data-action="imagegen" data-day="day2">Generate Memory for Day 2</button>
                    <div class="ai-image-container mt-4"></div>
                </div>
                 <div>
                    <button class="ai-action-button w-full bg-purple-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-purple-700 transition-colors" data-action="imagegen" data-day="day3">Generate Memory for Day 3</button>
                    <div class="ai-image-container mt-4"></div>
                </div>
                 <div>
                    <button class="ai-action-button w-full bg-purple-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-purple-700 transition-colors" data-action="imagegen" data-day="day4">Generate Memory for Day 4</button>
                    <div class="ai-image-container mt-4"></div>
                </div>
            </div>
        </div>

    </div>

    <div id="gemini-modal" class="modal modal-inactive fixed inset-0 bg-slate-900 bg-opacity-75 flex items-center justify-center p-4 z-50 no-print">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg p-6" id="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-slate-800" id="modal-title">✨ Itinerary Assistant</h3>
                <button id="modal-close" class="text-slate-500 hover:text-slate-800 text-3xl leading-none">×</button>
            </div>
            <div id="modal-body">
                <p class="text-sm text-slate-600 mb-4" id="modal-prompt-context"></p>
                <textarea id="modal-input" class="w-full border border-slate-300 rounded-lg p-2 text-sm" rows="3" placeholder="Ask a question..."></textarea>
                <button id="modal-submit" class="w-full mt-4 bg-indigo-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center">
                    <span id="submit-text">Ask Gemini</span>
                    <div id="submit-loader" class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-6 w-6 hidden"></div>
                </button>
                <div id="modal-response" class="mt-4 text-sm text-slate-700 bg-slate-50 p-4 rounded-lg border border-slate-200 hidden"></div>
            </div>
        </div>
    </div>

    <script>
        // --- Optimized Gemini API Integration & UI Logic ---

        const itineraryContainer = document.getElementById('itinerary-container');
        const mainContainer = document.querySelector('.max-w-4xl.mx-auto');

        // --- Event Delegation for all AI Action Buttons ---
        mainContainer.addEventListener('click', (e) => {
            const button = e.target.closest('.ai-action-button');
            if (!button) return;

            const action = button.dataset.action;
            
            if (action === 'logistics') {
                openLogisticsModal(button);
            } else if (action === 'imagegen') {
                handleImageGeneration(button);
            } else {
                handleInPageAiRequest(button);
            }
        });

        // --- In-Page AI Request Handler ---
        async function handleInPageAiRequest(button) {
            const cardBody = button.closest('.ml-4.bg-white, .bg-white.p-6.rounded-2xl, .bg-slate-50.rounded-xl');
            let responseContainer = cardBody.querySelector('.ai-response-container');
            // If the button is inside a sub-card, the response container is outside it.
            if (!responseContainer) {
                responseContainer = cardBody.closest('.ml-4.bg-white').querySelector('.ai-response-container');
            }
            const action = button.dataset.action;
            const context = button.dataset.context;
            const originalButtonText = button.innerHTML;

            button.innerHTML = 'Thinking...';
            button.disabled = true;

            const prompt = generateTextPrompt(action, context);
            const responseText = await callGemini(prompt);

            responseContainer.innerHTML = `<div class="bg-slate-100 border border-slate-200 p-4 rounded-lg text-sm">${responseText}</div>`;
            responseContainer.classList.add('active');

            button.innerHTML = originalButtonText;
            button.disabled = false;
        }
        
        // --- Image Generation Handler ---
        async function handleImageGeneration(button) {
            const dayId = button.dataset.day;
            const dayElement = document.getElementById(dayId);
            const imageContainer = button.nextElementSibling;
            
            // Create a summary of the day's activities for the prompt
            const activityTitles = Array.from(dayElement.querySelectorAll('h4')).map(h => h.textContent).join(', ');
            const imagePrompt = `Create a vibrant, stylized digital art postcard summarizing a fun day in the Bay Area. The day's activities included: ${activityTitles}. The style should be a mix of whimsical illustration and modern graphic design, capturing a sense of adventure and fun. Avoid text.`;

            button.textContent = 'Generating...';
            button.disabled = true;
            imageContainer.innerHTML = `<div class="image-loader"><div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12"></div></div>`;

            const imageUrl = await callImagen(imagePrompt);

            if (imageUrl) {
                 imageContainer.innerHTML = `<img src="${imageUrl}" alt="AI-generated memory of ${dayId}" class="w-full h-auto rounded-lg shadow-md">`;
            } else {
                imageContainer.innerHTML = `<p class="text-center text-sm text-red-600">Image generation failed. Please try again.</p>`;
            }
            button.style.display = 'none'; // Hide button after use
        }

        // --- Prompt Generation Logic ---
        function generateTextPrompt(action, context) {
            switch (action) {
                case 'food':
                    return `You are a food blogger specializing in the Bay Area. For a group with teenagers (one adult is vegan, the rest are not), provide a helpful, short summary for the following restaurant(s): ${context}. For each, suggest one "must-try" dish for a non-vegan and one for the vegan. Describe the general vibe (e.g., casual, lively) and price range (e.g., $, $$, $$$). Format using Markdown.`;
                case 'caption':
                    return `You are a witty social media caption writer. Generate 5 short, fun captions for a group with teenagers visiting "${context}". Include emojis and suggest a couple of popular local hashtags. Format as a numbered list.`;
                case 'alternative':
                    return `You are a creative Bay Area travel planner. For a group with teenagers, suggest 2 alternative activities for "${context}". The alternatives should be logistically feasible. For each, give a brief reason why it's a good fit for this group, its estimated cost, and operating hours. Format as a bulleted list.`;
                case 'teen':
                    return `You are a tour guide who is an expert at engaging teenagers. For "${context}", suggest one specific, non-obvious thing to look for, do, or photograph that a teenager would find cool or interesting. Be specific and avoid generic advice.`;
                case 'vibe':
                     return `Based on general knowledge, describe the "vibe" or atmosphere of "${context}". Is it loud or quiet? Casual or upscale? Good for a quick bite or a long conversation? Frame your answer for a group with teenagers.`;
                case 'funfact':
                    return `You are a museum tour guide. Tell me one mind-blowing, genuinely interesting fun fact about "${context}" that would capture a teenager's attention. Keep it concise.`;
                case 'weather':
                    return `You are a Bay Area local giving clothing advice. For "${context}", what specific clothing should a group wear? Mention layers, wind, or sun exposure as appropriate. Keep it short and practical.`;
                default:
                    return context; // Fallback
            }
        }

        // --- Logistics Modal Logic (remains mostly the same) ---
        const modal = document.getElementById('gemini-modal');
        const modalContent = document.getElementById('modal-content');
        const modalClose = document.getElementById('modal-close');
        const modalTitle = document.getElementById('modal-title');
        const modalInput = document.getElementById('modal-input');
        const modalSubmit = document.getElementById('modal-submit');
        const modalResponse = document.getElementById('modal-response');
        const modalPromptContext = document.getElementById('modal-prompt-context');
        const submitText = document.getElementById('submit-text');
        const submitLoader = document.getElementById('submit-loader');
        let currentItineraryContext = '';

        function openLogisticsModal(button) {
            const dayId = button.dataset.day;
            const dayTitle = button.dataset.title;
            const dayElement = document.getElementById(dayId);
            currentItineraryContext = dayElement.innerText;
            
            modalTitle.textContent = `✨ ${dayTitle}`;
            modalPromptContext.textContent = `Ask a question about the plan for Day ${dayId.slice(-1)}. For example: "What's the best way to get from the Exploratorium to the Mission?"`;
            modal.classList.remove('modal-inactive');
            modal.classList.add('modal-active');
            modalInput.value = '';
            modalResponse.innerHTML = '';
            modalResponse.classList.add('hidden');
        }

        function closeModal() {
            modal.classList.add('modal-inactive');
            modal.classList.remove('modal-active');
        }

        modalClose.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });

        modalSubmit.addEventListener('click', async () => {
            const question = modalInput.value.trim();
            if (!question) return;

            submitText.classList.add('hidden');
            submitLoader.classList.remove('hidden');
            modalSubmit.disabled = true;

            const prompt = `You are a friendly and helpful Bay Area logistics expert. Based on the following itinerary context, answer the user's question concisely and accurately.\nItinerary Context: ---\n${currentItineraryContext}\n---\nUser's Question: "${question}"`;

            const responseText = await callGemini(prompt);
            
            modalResponse.innerHTML = responseText;
            modalResponse.classList.remove('hidden');
            
            submitText.classList.remove('hidden');
            submitLoader.classList.add('hidden');
            modalSubmit.disabled = false;
        });

        // --- Core API Call Functions ---
        const apiKey = "AIzaSyBjub51CB-YM9gTdS2fH9q9A4lQWva0FK4"; // API key has been inserted here.

        async function fetchWithRetry(apiUrl, payload, maxRetries = 3) {
            let attempt = 0;
            let delay = 1000; // start with 1 second

            while (attempt < maxRetries) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (response.status === 503) {
                        throw new Error(`Service temporarily unavailable (503)`);
                    }

                    if (!response.ok) {
                        throw new Error(`API request failed with status ${response.status}`);
                    }

                    return await response.json();

                } catch (error) {
                    attempt++;
                    if (attempt >= maxRetries) {
                        console.error(`API call failed after ${maxRetries} attempts. Error: ${error.message}`);
                        throw error;
                    }
                    console.warn(`Attempt ${attempt} failed: ${error.message}. Retrying in ${delay / 1000}s...`);
                    await new Promise(resolve => setTimeout(resolve, delay));
                    delay *= 2; // Exponential backoff
                }
            }
        }

        async function callGemini(prompt) {
            if (!apiKey) return "AI functionality is currently unavailable. API key is missing.";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`;
            const payload = { contents: [{ parts: [{ text: prompt }] }] };

            try {
                const result = await fetchWithRetry(apiUrl, payload);
                if (result.candidates && result.candidates.length > 0) {
                    let text = result.candidates[0].content.parts[0].text;
                    // Basic Markdown to HTML conversion
                    return text
                        .replace(/\*\*(.*?)\*\*/g, '<strong class="text-slate-900">$1</strong>')
                        .replace(/^\* (.*?)$/gm, '<li class="ml-4 list-disc">$1</li>')
                        .replace(/(\r\n|\n|\r)/g, "<br>");
                } else {
                    console.error("Unexpected Gemini API response structure:", result);
                    return "Sorry, I couldn't get a valid response. Please try again.";
                }
            } catch (error) {
                return "Sorry, the AI service seems to be unavailable right now. Please try again later.";
            }
        }

        async function callImagen(prompt) {
             if (!apiKey) {
                console.error("API Key is missing for Imagen.");
                return null;
            }
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict?key=${apiKey}`;
            const payload = { instances: [{ prompt: prompt }], parameters: { "sampleCount": 1 } };

            try {
                const result = await fetchWithRetry(apiUrl, payload);
                if (result.predictions && result.predictions.length > 0 && result.predictions[0].bytesBase64Encoded) {
                    return `data:image/png;base64,${result.predictions[0].bytesBase64Encoded}`;
                } else {
                     console.error("Unexpected Imagen API response:", result);
                    return null;
                }
            } catch (error) {
                return null;
            }
        }
    </script>
</body>
</html>
